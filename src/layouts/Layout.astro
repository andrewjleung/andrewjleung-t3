---
import "@/styles/global.css";
import "@fontsource-variable/geist";
import "@/styles/global.css";
import clsx from "clsx";
import Breadcrumbs from "@/components/breadcrumbs.astro";
import Head from "@/components/head.astro";
import { ModeToggle } from "@/components/mode-toggle";

const {
    title = "Andrew Leung",
    description = "Yet another tech portfolio and blog.",
    pageTitle,
    showHeader = false,
} = Astro.props;
---

<script is:inline>
    const getThemePreference = () => {
        if (
            typeof localStorage !== "undefined" &&
            localStorage.getItem("theme")
        ) {
            return localStorage.getItem("theme");
        }
        return window.matchMedia("(prefers-color-scheme: dark)").matches
            ? "dark"
            : "light";
    };
    const isDark = getThemePreference() === "dark";
    document.documentElement.classList[isDark ? "add" : "remove"]("dark");

    if (typeof localStorage !== "undefined") {
        const observer = new MutationObserver(() => {
            const isDark = document.documentElement.classList.contains("dark");
            localStorage.setItem("theme", isDark ? "dark" : "light");
        });
        observer.observe(document.documentElement, {
            attributes: true,
            attributeFilter: ["class"],
        });
    }
</script>

<!doctype html>
<html lang="en">
    <head>
        <Head title={title} description={description}/>
    </head>
    <body class={clsx(
        "h-screen px-6 lg:px-0 flex flex-col items-center justify-between",
    )}>
        {showHeader && <header class="animate-fade-in-up mb-5 md:pt-2 md:border-t mt-8 md:mt-24 peer header w-full md:max-w-2xl">
            <Breadcrumbs />
            <h2 class="text-4xl">{pageTitle}</h2>
        </header>}
        
        <main class={clsx(
            "flex flex-col gap-5 md:mb-36 w-full grow mb-8", 
            "md:pt-2 md:peer-[.header]:pt-0",
            "md:border-t md:peer-[.header]:border-0",
            "mt-8 md:mt-24 peer-[.header]:mt-0",
            "w-full md:max-w-2xl",
        )}>
            <slot />
        </main>

        <footer class="pb-8 md:pb-24 translate-y-32 sm:translate-y-0 w-full md:max-w-2xl">
            <section id="links" class="grid grid-cols-2 sm:grid-cols-4 pt-2 border-t **:text-sm sm:**:text-xs mb-6 sm:mb-8 gap-8">
                <div class="col-span-1 flex flex-col gap-1 *:gap-1">
                    <h2 class="">Pages</h2>
                    <nav
                        class="flex flex-col *:hover:text-foreground transition-all duration-100 ease-out text-muted-foreground"
                    >
                        <a href="/">Home</a>
                        <a href="/blog">Blog</a>
                        <a href="/work">Work</a>
                    </nav>
                </div>

                <div class="col-span-1 flex flex-col gap-1 *:gap-1">
                    <h2 class="">Personal</h2>
                    <nav
                        class="flex flex-col *:hover:text-foreground transition-all duration-100 ease-out text-muted-foreground"
                    >
                        <a href="https://github.com/andrewjleung">GitHub</a>
                        <a href="https://open.spotify.com/artist/00zDjeTQDVOFlNttOnv9bc"
                        >Spotify</a
                        >
                        <a
                            href="https://www.youtube.com/channel/UCVxaN-2GATE-3Ag9RTGrIXw"
                        >YouTube</a
                        >
                    </nav>
                </div>

                <div class="col-span-1 flex flex-col gap-1 *:gap-1">
                    <h2 class="">Professional</h2>
                    <nav
                        class="flex flex-col *:hover:text-foreground  transition-all duration-100 ease-out text-muted-foreground"
                    >
                        <a href="mailto:andrewleung104@gmail.com">Contact</a>
                        <a href="https://linkedin.com/in/andrewjleung-">LinkedIn</a>
                        <a href="/resume" class="flex flex-row items-center">Resume</a>
                    </nav>
                </div>
            </section>

            <section class="w-full mt-auto pt-2 *:text-[0.75em] sm:*:text-[0.7em] border-t grid grid-cols-1 sm:grid-cols-2 *:text-muted-foreground gap-1 sm:gap-0">
                <div class="col-span-1 flex flex-col gap-1">
                    <div>
                        <span class="sm:whitespace-nowrap">Â© {new Date().getFullYear()} Andrew Leung.</span> All rights reserved.
                    </div>
                    <div>
                        <a href="https://github.com/andrewjleung/web" class="whitespace-nowrap hover:text-foreground">Source on GitHub</a>
                    </div>
                </div>

                <div class="col-span-1 sm:text-right flex flex-col gap-1">
                    <div>
                        <a href="#" class="whitespace-nowrap hover:text-foreground">Back to top</a>
                    </div>
                    <div>
                        <ModeToggle client:idle />
                    </div>
                </div>
            </section>
        </footer>
    </body>
</html>

<style>
</style>
